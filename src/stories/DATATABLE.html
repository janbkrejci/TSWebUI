<div class="sl-theme-{{theme}} main-container">
    <script>
        // Utility functions for page number input
        let inputClick = (event) => {
            event.target.select();
            event.preventDefaul        function populateTableData() {);
        };
        
        let inputKeyDown = (event) => {
            if (!/[0-9]/.test(event.key) && event.key !== 'Backspace' && event.key !== 'Delete' && event.key !== 'ArrowLeft' && event.key !== 'ArrowRight') {
                event.preventDefault();
            }
            if (event.key === 'Enter') {
                event.target.blur();
            }
        };
        
        let inputBlur = (event) => {
            let value = parseInt(event.target.value);
            if (isNaN(value) || value < 1) {
                event.target.value = 1;
            } else if (value > 15) {
                event.target.value = 15;
            }
        };

        // Table data
        const tableData = [
            {
                id: 1,
                name: "Leanne Graham",
                username: "Bret",
                email: "leanne@example.com",
                city: "London",
                phone: "555-1234",
                website: "www.leannegraham.com",
                company: "Example Corp"
            },
            {
                id: 2,
                name: "Ervin Howell",
                username: "Antonette",
                email: "ervin@example.com",
                city: "Paris",
                phone: "555-5678",
                website: "www.ervinhowell.com",
                company: "Howell LLC"
            },
            {
                id: 3,
                name: "Clementine Bauch",
                username: "Samantha",
                email: "clementine@example.com",
                city: "Berlin",
                phone: "555-8765",
                website: "www.clementine.com",
                company: "Bauch Group"
            },
            {
                id: 4,
                name: "Patricia Lebsack",
                username: "Karianne",
                email: "patricia@example.com",
                city: "Madrid",
                phone: "555-4321",
                website: "www.patricia.com",
                company: "Lebsack Ltd"
            },
            {
                id: 5,
                name: "Chelsey Dietrich",
                username: "Kameron",
                email: "chelsey@example.com",
                city: "Rome",
                phone: "555-2468",
                website: "www.chelsey.com",
                company: "Dietrich Inc"
            },
            {
                id: 6,
                name: "Mrs. Dennis Schulist",
                username: "Leopoldo_Corkery",
                email: "dennis@example.com",
                city: "Vienna",
                phone: "555-1357",
                website: "www.dennis.com",
                company: "Schulist Group"
            },
            {
                id: 7,
                name: "Kurtis Weissnat",
                username: "Elwyn.Skiles",
                email: "kurtis@example.com",
                city: "Prague",
                phone: "555-9753",
                website: "www.kurtis.com",
                company: "Weissnat LLC"
            },
            {
                id: 8,
                name: "Nicholas Runolfsdottir",
                username: "Maxime_Nienow",
                email: "nicholas@example.com",
                city: "Brno",
                phone: "555-8642",
                website: "www.nicholas.com",
                company: "Runolfsdottir Ltd"
            },
            {
                id: 9,
                name: "Glenna Reichert",
                username: "Delphine",
                email: "glenna@example.com",
                city: "Ostrava",
                phone: "555-7531",
                website: "www.glenna.com",
                company: "Reichert Group"
            },
            {
                id: 10,
                name: "Clementina DuBuque",
                username: "Moriah.Stanton",
                email: "clementina@example.com",
                city: "Plze≈à",
                phone: "555-1597",
                website: "www.clementina.com",
                company: "DuBuque Inc"
            }
        ];

        // Column mapping for dynamic table creation
        const columns = {
            'ID': 'id',
            'Name': 'name',
            'Username': 'username',
            'Email': 'email',
            'City': 'city',
            'Phone': 'phone',
            'Website': 'website',
            'Company': 'company'
        };

        // Populate table with data
        function populateTable() {
            console.log('üîÑ Populating table...');
            const tbody = document.querySelector('tbody');
            console.log('üîÑ Found tbody:', tbody);
            
            if (!tbody) {
                console.error('‚ùå Table body not found');
                return;
            }

            // Clear existing rows
            tbody.innerHTML = '';
            console.log('üîÑ Cleared existing rows');

            // First, try adding a simple test row
            const testRow = document.createElement('tr');
            testRow.style.backgroundColor = 'yellow'; // Make it obvious
            testRow.innerHTML = `
                <td>TEST</td>
                <td>1</td>
                <td>Test Name</td>
                <td>test_user</td>
                <td>test@example.com</td>
                <td>Test City</td>
                <td>555-0000</td>
                <td>www.test.com</td>
                <td>Test Company</td>
            `;
            tbody.appendChild(testRow);
            console.log('üß™ Added test row');

            // Now create rows from data using innerHTML approach
            let htmlRows = '';
            tableData.forEach((rowData, index) => {
                console.log(`üîÑ Creating row ${index + 1}:`, rowData);
                
                htmlRows += `
                    <tr onclick="rowClicked(event)" style="display: table-row; visibility: visible;">
                        <td style="text-align: center; padding: 0.5em 1em; border-bottom: 1px solid #ccc;">‚òê</td>
                        <td style="padding: 0.5em 1em; border-bottom: 1px solid #ccc;">${rowData.id}</td>
                        <td style="padding: 0.5em 1em; border-bottom: 1px solid #ccc;">${rowData.name}</td>
                        <td style="padding: 0.5em 1em; border-bottom: 1px solid #ccc;">${rowData.username}</td>
                        <td style="padding: 0.5em 1em; border-bottom: 1px solid #ccc;">${rowData.email}</td>
                        <td style="padding: 0.5em 1em; border-bottom: 1px solid #ccc;">${rowData.city}</td>
                        <td style="padding: 0.5em 1em; border-bottom: 1px solid #ccc;">${rowData.phone}</td>
                        <td style="padding: 0.5em 1em; border-bottom: 1px solid #ccc;">${rowData.website}</td>
                        <td style="padding: 0.5em 1em; border-bottom: 1px solid #ccc;">${rowData.company}</td>
                    </tr>
                `;
            });
            
            // Set all rows at once
            tbody.innerHTML = testRow.outerHTML + htmlRows;
            console.log('üîÑ Set tbody innerHTML with all rows');

            // Final check
            const allRows = tbody.querySelectorAll('tr');
            console.log(`‚úÖ Table populated. Total rows in tbody: ${allRows.length}`);
            console.log('üìä All rows:', Array.from(allRows));
            console.log('üìä tbody HTML preview:', tbody.innerHTML.substring(0, 200) + '...');
        }

        // Handle row clicks
        let rowClicked = (event) => {
            if (event.target.closest('sl-checkbox') || event.target.tagName === 'SL-CHECKBOX') {
                return;
            }
            let row = event.currentTarget;
            let id = row.cells[1].textContent;
            console.log('Row clicked with ID:', id);
        };

        // Simple immediate population - let's try the most direct approach
        function forcePopulateNow() {
            console.log('ÔøΩ FORCE POPULATE NOW!');
            
            // Find table using specific ID
            const table = document.getElementById('data-table');
            if (!table) {
                console.error('‚ùå Table with ID "data-table" not found!');
                console.log('Available elements with IDs:', Array.from(document.querySelectorAll('[id]')).map(el => el.id));
                return false;
            }
            console.log('‚úÖ Found table by ID:', table);
            
            const tbody = table.querySelector('tbody');
            if (!tbody) {
                console.error('‚ùå tbody not found in table!');
                return false;
            }
            console.log('‚úÖ Found tbody:', tbody);
            
            // Clear and add conspicuous test row
            tbody.innerHTML = `
                <tr style="background: #ff0000; height: 60px; border: 5px solid #000000;">
                    <td colspan="9" style="text-align: center; color: white; font-weight: bold; padding: 20px; font-size: 18px;">
                        ‚úÖ SUCCESS! Table found by ID and populated!
                    </td>
                </tr>
            `;
            
            // Add actual data rows
            tableData.forEach((row, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><sl-checkbox></sl-checkbox></td>
                    <td>${row.id}</td>
                    <td>${row.name}</td>
                    <td>${row.username}</td>
                    <td>${row.email}</td>
                    <td>${row.city}</td>
                    <td>${row.phone}</td>
                    <td>${row.website}</td>
                    <td>${row.company}</td>
                `;
                tbody.appendChild(tr);
            });
            
            const finalRowCount = tbody.querySelectorAll('tr').length;
            console.log(`‚úÖ Successfully added ${finalRowCount} rows (1 test + ${tableData.length} data)`);
            return true;
        }

        // Initialize table with retry logic
        function initializeTable() {
            console.log('üöÄ Initializing DataTable...');
            
            // Try populate by ID first
            if (forcePopulateNow()) {
                console.log('‚úÖ Table populate succeeded');
            } else {
                console.log('‚ùå Table populate failed, will retry');
                setTimeout(initializeTable, 200);
                return;
            }
            
            // Add listener to column menu sl-select event
            const columnsMenu = document.querySelector('.columns-menu');
            if (columnsMenu) {
                console.log('‚úÖ Column menu found, adding event listener');
                columnsMenu.addEventListener('sl-select', (event) => {
                    console.log('Column menu event triggered');
                    forcePopulateNow();
                });
            }
        }

        // Multiple initialization attempts
        console.log('üîç Starting multiple initialization attempts...');
        
        // Attempt 1: Immediate
        setTimeout(initializeTable, 10);
        
        // Attempt 2: Short delay
        setTimeout(initializeTable, 100);
        
        // Attempt 3: Medium delay
        setTimeout(initializeTable, 500);
        
        // Attempt 4: DOM ready
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üìÑ DOM loaded - trying initialization');
            initializeTable();
        });
        
        // Attempt 5: Window load
        window.addEventListener('load', () => {
            console.log('üåç Window loaded - trying initialization');
            initializeTable();
        });

        // Debug function to check table state
        function debugTable() {
            console.log('üîç === TABLE DEBUG ===');
            const table = document.querySelector('table');
            const tbody = document.querySelector('tbody');
            const rows = tbody ? tbody.querySelectorAll('tr') : [];
            
            console.log('üîç Table element:', table);
            console.log('üîç Tbody element:', tbody);
            console.log('üîç Number of rows:', rows.length);
            console.log('üîç Table HTML:', table ? table.outerHTML.substring(0, 500) + '...' : 'No table');
            console.log('üîç Tbody HTML:', tbody ? tbody.innerHTML.substring(0, 500) + '...' : 'No tbody');
            
            if (rows.length > 0) {
                console.log('üîç First row:', rows[0]);
                console.log('üîç First row HTML:', rows[0].outerHTML);
            }
            
            // Check computed styles
            if (tbody) {
                const styles = window.getComputedStyle(tbody);
                console.log('üîç Tbody display:', styles.display);
                console.log('üîç Tbody visibility:', styles.visibility);
            }
            
            console.log('üîç === END DEBUG ===');
        }

        // Global functions for debugging
        window.populateTable = populateTable;
        window.initializeTable = initializeTable;
        window.tableData = tableData;
        window.debugTable = debugTable;
    </script>
    <div id="container">
        <!-- DATATABLE -->
        <!-- Toolbar -->
        <div class="toolbar">
            <div>
                <sl-button variant="success" circle>
                    <sl-icon name="plus"></sl-icon>
                </sl-button>
            </div>
            <div class="toolbar-center">
                <sl-button variant="danger">
                    <sl-icon name="trash"></sl-icon>
                </sl-button>
                <sl-button>Export to Excel</sl-button>
            </div>
            <div>
                <sl-dropdown>
                    <sl-button slot="trigger" caret>Columns</sl-button>
                    <sl-menu class="columns-menu">
                        <sl-menu-item>Select All</sl-menu-item>
                        <sl-menu-item>Clear All</sl-menu-item>
                        <sl-divider></sl-divider>
                        <sl-input placeholder="Search columns..." class="search-input"></sl-input>
                        <sl-menu-item type="checkbox">ID</sl-menu-item>
                        <sl-menu-item type="checkbox">Name</sl-menu-item>
                        <sl-menu-item type="checkbox">Username</sl-menu-item>
                        <sl-menu-item type="checkbox">Email</sl-menu-item>
                        <sl-menu-item type="checkbox">City</sl-menu-item>
                        <sl-menu-item type="checkbox">Phone</sl-menu-item>
                        <sl-menu-item type="checkbox">Website</sl-menu-item>
                        <sl-menu-item type="checkbox">Company</sl-menu-item>
                    </sl-menu>
                </sl-dropdown>
            </div>
        </div>
        <div class="table-container">
            <table id="data-table">
                <thead>
                    <tr>
                        <th class="checkbox-column"></th>
                        <th class="id-column">ID</th>
                        <th>Name
                            <span class="sort-indicator">
                                <svg width="10" height="16" viewBox="0 0 10 16" class="sort-svg">
                                    <polygon points="5,3 1,7 9,7" fill="var(--sl-color-neutral-500)" />
                                    <polygon points="5,13 1,9 9,9" fill="var(--sl-color-neutral-300)" />
                                </svg>
                            </span>
                        </th>
                        <th>Username
                            <span class="sort-indicator">
                                <svg width="10" height="16" viewBox="0 0 10 16" class="sort-svg">
                                    <polygon points="5,3 1,7 9,7" fill="var(--sl-color-neutral-300)" />
                                    <polygon points="5,13 1,9 9,9" fill="var(--sl-color-neutral-500)" />
                                </svg>
                            </span>
                        </th>
                        <th>Email</th>
                        <th>City</th>
                        <th>Phone</th>
                        <th>Website</th>
                        <th>Company</th>
                    </tr>
                    <tr class="filter-row">
                        <th class="checkbox-column"><sl-checkbox></sl-checkbox></th>
                        <th><sl-input size="small" placeholder="Filter ID"></sl-input></th>
                        <th><sl-input size="small" placeholder="Filter Name"></sl-input></th>
                        <th><sl-input size="small" placeholder="Filter Username"></sl-input></th>
                        <th><sl-input size="small" placeholder="Filter Email"></sl-input></th>
                        <th><sl-input size="small" placeholder="Filter City"></sl-input></th>
                        <th><sl-input size="small" placeholder="Filter Phone"></sl-input></th>
                        <th><sl-input size="small" placeholder="Filter Website"></sl-input></th>
                        <th><sl-input size="small" placeholder="Filter Company"></sl-input></th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Table rows will be populated dynamically by populateTable() function -->
                </tbody>
            </table>
        </div>
        <!-- FOOTER -->
        <div class="footer">
            <div id="item-count">Vybr√°no 10 z 500</div>
            <div class="items-per-page">
                Zobrazit
                <sl-dropdown>
                    <sl-button slot="trigger">
                        10
                        <sl-icon name="chevron-down" class="chevron-icon"></sl-icon>
                    </sl-button>

                    <sl-menu>
                        <sl-menu-item>5</sl-menu-item>
                        <sl-menu-item>10</sl-menu-item>
                        <sl-menu-item>20</sl-menu-item>
                        <sl-menu-item>50</sl-menu-item>
                        <sl-menu-item>100</sl-menu-item>
                        <sl-menu-item>1000</sl-menu-item>
                    </sl-menu>
                </sl-dropdown>
                na str√°nku
            </div>
            <!-- PAGER -->
            <div class="pager" onclick="pageDropdownClicked(event)">
                <sl-button-group>
                    <sl-button disabled>
                        <sl-icon name="chevron-bar-left"></sl-icon>
                    </sl-button>
                    <sl-button disabled>
                        <sl-icon name="chevron-left"></sl-icon>
                    </sl-button>
                </sl-button-group>
                <div id="page-info" variant="none">
                    Str√°nka
                    <sl-input id="page-number" size="small" value="8" onclick="inputClick(event)"
                        onkeydown="inputKeyDown(event)" onblur="inputBlur(event)"></sl-input>
                    / 15
                </div>

                <sl-button-group>
                    <sl-button>
                        <sl-icon name="chevron-right"></sl-icon>
                    </sl-button>
                    <sl-button>
                        <sl-icon name="chevron-bar-right"></sl-icon>
                    </sl-button>
                </sl-button-group>
            </div>
        </div>
    </div>
</div>